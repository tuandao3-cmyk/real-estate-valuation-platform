{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Income Approach Output Schema",
    "description": "Schema for intermediate valuation output generated by the Income Approach. This output is strictly non-decisional and must not be treated as final market value.",
    "type": "object",
    "additionalProperties": false,
    "required": [
        "model_metadata",
        "indicated_value",
        "inputs_snapshot",
        "calculation_timestamp",
        "limitations",
        "governance_flags"
    ],
    "properties": {
        "model_metadata": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "model_name",
                "model_version",
                "governance_role"
            ],
            "properties": {
                "model_name": {
                    "type": "string",
                    "const": "IncomeApproachModel"
                },
                "model_version": {
                    "type": "string",
                    "pattern": "^v[0-9]+\\.[0-9]+\\.[0-9]+$"
                },
                "governance_role": {
                    "type": "string",
                    "const": "INCOME_CALCULATION_ONLY"
                }
            }
        },
        "indicated_value": {
            "type": "number",
            "minimum": 0,
            "description": "Indicative value derived mechanically from NOI and cap rate. This is NOT a final valuation."
        },
        "inputs_snapshot": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "net_operating_income",
                "cap_rate",
                "assumptions_version",
                "cap_rate_table_version"
            ],
            "properties": {
                "net_operating_income": {
                    "type": "number",
                    "minimum": 0
                },
                "cap_rate": {
                    "type": "number",
                    "exclusiveMinimum": 0
                },
                "assumptions_version": {
                    "type": "string"
                },
                "cap_rate_table_version": {
                    "type": "string"
                }
            }
        },
        "calculation_timestamp": {
            "type": "string",
            "format": "date-time",
            "description": "UTC timestamp of income calculation execution."
        },
        "limitations": {
            "type": "string",
            "description": "Mandatory disclosure of methodological and governance limitations."
        },
        "governance_flags": {
            "type": "object",
            "additionalProperties": false,
            "required": [
                "human_cap_rate_selected",
                "activation_required",
                "auto_decision_prohibited",
                "final_value_prohibited"
            ],
            "properties": {
                "human_cap_rate_selected": {
                    "type": "boolean",
                    "const": true
                },
                "activation_required": {
                    "type": "boolean",
                    "const": true
                },
                "auto_decision_prohibited": {
                    "type": "boolean",
                    "const": true
                },
                "final_value_prohibited": {
                    "type": "boolean",
                    "const": true
                }
            }
        }
    }
}